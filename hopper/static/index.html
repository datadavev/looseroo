<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Hopper</title>
    <script src="static/main.js"></script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "WebPage",
        "name": "Hopper",
        "description": "hopperis a service that connects to a user provided URL, follows redirects to the ultimate target, and reports the hops taken.",
        "author": {
            "@type": "Person",
            "name": "datadavev",
            "identifier": "https://orcid.org/0000-0002-6513-4996"
        },
        "license": "https://opensource.org/license/mit",
        "subjectOf": "https://github.com/datadavev/looseroo"
    }
    </script>
</head>
<body>
<header>
    <h1>Hopper</h1>
    <details>
        <summary>About</summary>
    <p><code>hopper</code> is a service that connects to a user provided URL, follows redirects
        to the ultimate target, and reports the hops taken.
    </p>
    <p>Visit the hopper <a href="/api">API</a>.</p>
    <p>Project on <a href="https://github.com/datadavev/looseroo">GitHub</a>.</p>
    </details>
</header>
<main>
    <p>
<label for="target">URL to evaluate:</label>
    </p><p>
<input id="target" name="target" type="text" size="80" placeholder="URL"/>
    </p>
    <details>
        <summary>Options:</summary>
        <p>
            <label for="accept">
                <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept" target="_blank">Accept header</a> value:
            </label>
        </p>
        <p>
            <input id="accept" name="accept" list="accept_options"type="text" size="80" value="*/*" />
            <datalist id="accept_options">
                <option selected value="*/*"></option>
                <option value="text/html"></option>
                <option value="text/plain"></option>
                <option value="application/json"></option>
                <option value="application/ld+json"></option>
                <option value="application/ld+json,application/json,*/*;q=0.1"></option>
            </datalist>
        </p>
        <p>
            <label for="whitehosts">Follow redirects on these hosts only:</label>
        </p>
        <p>
            <input id="whitehosts" name="whitehosts" type="text" size="80" placeholder="Any" value="" />
        </p>
    </details>
    <p>
        <button id="submit" name="submit" type="submit" onclick="doLoadUrl()">Submit</button>
    </p>
<section>
    <pre id="output"></pre>
</section>
</main>
<script>
    const inp = document.getElementById("target");
    const loc = document.location.hash.match(url_pattern);
    inp.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            event.preventDefault();
            document.getElementById("submit").click();
        }
    });
    if (loc) {
        inp.value = loc[0];
        doLoadUrl();
    }
</script>
</body>
</html>
